CREATE DEFINER=`root`@`localhost` PROCEDURE `PA_INSERTAR_NO_TRANSACCIONAL`( 
    in PIDCUENTAORIGEN INT, in PIDCUENTADESTINO INT, in PVALOR NUMERIC (10,2))
BEGIN
    START TRANSACTION;

    INSERT INTO TRANSFERENCIA 
        VALUES (PIDCUENTAORIGEN, PIDCUENTADESTINO, PVALOR);
    UPDATE CUENTA
        SET SALDO = SALDO + PVALOR
        WHERE IDCUENTA = PIDCUENTADESTINO;

    UPDATE CUENTA
        SET SALDO = SALDO - PVALOR
        WHERE IDCUENTA = PIDCUENTAORIGEN;
    INSERT INTO MOVIMIENTO (IDCUENTA, TIPOMOVIMIENTO, VALOR)
        VALUES (PIDCUENTADESTINO, 'A', PVALOR);
     INSERT INTO MOVIMIENTO (IDCUENTA, TIPOMOVIMIENTO, VALOR)
        VALUES (PIDCUENTAORIGEN, 'D', PVALOR);


    COMMIT;
END
